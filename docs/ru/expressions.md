# Выражения

Оригинальный компонент: <https://github.com/matheval/expression-evaluator-c-sharp/blob/main/README.md>

## Поддерживаемые операторы

| Оператор | Описание                                                                 |
| -------- | ------------------------------------------------------------------------ |
| `+`      | Сложение / унарный плюс / объединение строк / прибавление даты           |
| `&`      | Объединение строк                                                        |
| `–`      | Вычитание / унарный минус / вычитание даты                               |
| `*`      | Умножение (может быть опущено перед открывающей скобкой)                 |
| `/`      | Деление                                                                  |
| `%`      | Остаток от деления (модуль)                                              |
| `^`      | Возведение в степень                                                     |

## Поддерживаемые условные операторы

| Условный оператор                                               | Описание                                                  |
| --------------------------------------------------------------- | --------------------------------------------------------- |
| `IF(logical_condition, value_if_true, value_if_false)`          | Пример: `IF(2>1,"Pass","Fail")`                           |
| `SWITCH(expression, val1,result1, [val2,result2], …, [default])`| Пример: `SWITCH(3+2,5,"Apple",7,"Mango",3,"Good","N/A")`  |

## Поддерживаемые логические и математические функции

| Функция                          | Описание                                                                        |
| -------------------------------- | ------------------------------------------------------------------------------- |
| `AND(logical1, [logical2], …)`   | Проверяет, что все условия TRUE                                                 |
| `OR(logical1, [logical2], …)`    | Проверяет, что любое из условий TRUE                                            |
| `NOT(_logical_)`                 | Проверяет, что значение отличается от другого                                   |
| `XOR(logical1, [logical2], …)`   | Исключающее ИЛИ                                                                 |
| `SUM(number1, [number2],…)`      | Сумма указанных чисел                                                           |
| `AVERAGE(number1, [number2],…)`  | Среднее значение среди указанных чисел                                          |
| `MIN(number1, [number2],…)`      | Возвращает наименьшее значение из указанных чисел                               |
| `MAX(number1, [number2],…)`      | Возвращает наибольшее значение из указанных чисел                               |
| `MOD(number, divisor)`           | Остаток от деления двух чисел                                                   |
| `ROUND(number, num_digits)`      | Округляет число до указанного количества знаков                                 |
| `FLOOR(number, significance)`    | Округление вниз до ближайшего кратного числа                                    |
| `CEILING(number, significance)`  | Округление вверх до ближайшего кратного числа                                   |
| `POWER(number, power)`           | Возведение числа в указанную степень                                            |
| `RAND()`                         | Генерация случайного числа от 0 до 1                                            |
| `SIN(number)`                    | Синус угла в радианах                                                           |
| `SINH(number)`                   | Гиперболический синус                                                           |
| `ASIN(number)`                   | Арксинус в радианах                                                             |
| `COS(number)`                    | Косинус угла в радианах                                                         |
| `COSH(number)`                   | Гиперболический косинус                                                         |
| `ACOS(number)`                   | Арккосинус в радианах                                                           |
| `TAN(number)`                    | Тангенс угла в радианах                                                         |
| `TANH(number)`                   | Гиперболический тангенс                                                         |
| `ATAN(number)`                   | Арктангенс                                                                      |
| `ATAN2(x_number, y_number)`      | Арктангенс по координатам x и y                                                 |
| `COT(number)`                    | Котангенс угла в радианах                                                       |
| `COTH(number)`                   | Гиперболический котангенс                                                       |
| `SQRT(number)`                   | Квадратный корень                                                               |
| `LN(number)`                     | Натуральный логарифм (основание `e`)                                            |
| `LOG10(number)`                  | Десятичный логарифм                                                             |
| `EXP(number)`                    | Экспоненциальная функция                                                        |
| `ABS(number)`                    | Абсолютное значение                                                             |
| `FACT(number)`                   | Факториал числа                                                                 |
| `SEC(number)`                    | Секанс угла в радианах                                                          |
| `CSC(number)`                    | Косеканс угла в радианах                                                        |
| `PI()`                           | Возвращает значение Pi                                                          |
| `RADIANS(degrees)`               | Перевод градусов в радианы                                                     |
| `DEGREES(radians)`               | Перевод радиан в градусы                                                       |
| `INT(number)`                    | Возвращает целую часть числа                                                    |

## Поддерживаемые константы

| Константа | Описание               |
| --------- | ---------------------- |
| `e`       | Число Эйлера `e`       |
| `PI`      | Число Pi               |
| `TRUE`    | Булевое значение TRUE  |
| `FALSE`   | Булевое значение FALSE |
| `NULL`    | Значение NULL          |

Также доступны все переменные, объявленные в разделе *Variables* внутри рецепта.

```
Variables: Tier=1
```

Теперь переменная `Tier` может использоваться в выражениях.

## Поддерживаемые текстовые функции

| Функция                                          | Описание                                                                     |
| ------------------------------------------------ | -----------------------------------------------------------------------------|
| `LEFT(text, num_chars)`                          | Извлекает указанное количество символов с начала строки                      |
| `RIGHT(text, num_chars)`                         | Извлекает указанное количество символов с конца строки                       |
| `MID(text, start_num, num_chars)`                | Извлекает заданное количество символов из строки                             |
| `REVERSE(text)`                                  | Переворачивает строку                                                        |
| `ISNUMBER(text)`                                 | Проверяет, является ли значение числом                                       |
| `LOWER(text)`                                    | Преобразует текст в нижний регистр                                           |
| `UPPER(text)`                                    | Преобразует текст в верхний регистр                                          |
| `PROPER(text)`                                   | Делает первую букву каждого слова заглавной                                 |
| `TRIM(text)`                                     | Удаляет лишние пробелы из строки                                             |
| `LEN(text)`                                      | Возвращает длину строки                                                      |
| `TEXT(value, [format_text])`                     | Преобразует значение в текст с указанием формата                             |
| `REPLACE(old_text, start_num, num_chars, new_text)` | Заменяет часть строки на другую, начиная с указанного символа               |
| `SUBSTITUTE(text, old_text, new_text)`           | Заменяет все вхождения одного текста другим                                  |
| `FIND(find_text, within_text, [start_num])`      | Возвращает позицию подстроки (с учетом регистра)                             |
| `SEARCH(find_text, within_text, [start_num])`    | Возвращает позицию подстроки (без учета регистра)                           |
| `CONCAT(text1, text2, …)`                        | Объединяет несколько строк                                                   |
| `ISBLANK(text)`                                  | Возвращает TRUE, если строка пуста или равна NULL                           |
| `REPT(text, repeat_times)`                       | Повторяет текст указанное количество раз                                    |
| `CHAR(char_code)`                                | Возвращает символ по коду ASCII                                             |
| `CODE(char)`                                     | Возвращает ASCII-код символа                                                |
| `VALUE(text)`                                    | Преобразует текст в число                                                   |

## Примеры работы с текстом

```
TEXT(123) -> 123

TEXT(DATEVALUE("2021-01-23"),"dd-MM-yyyy") -> 23-01-2021

TEXT(2.61,"hh:mm") -> 14:38

TEXT(2.61,"[hh]") -> 62

TEXT(2.61,"hh-mm-ss") -> 14-38-24

TEXT(DATEVALUE("2021-01-03")-DATEVALUE("2021-01-01"),"[h]") -> 48

TEXT(TIME(12,00,00)-TIME(10,30,10),"hh hours and mm minutes and ss seconds") -> "01 hours and 29 minutes and 50 seconds"
```